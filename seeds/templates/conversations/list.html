{% extends "layout-wide.html" %}

{% block title %}Conversations{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-9">
    <a class="btn btn-primary float-right" href="{% url 'conversation_create' %}"><i class="fas fa-plus"></i> Add new conversation</a>
    <h1 class="mb-3">
      Conversations
      {% if search.person %}
        <span class="badge badge-info">
          {{ search.person }}
          <a href="{% url 'person_detail' search.person.slug %}"><i class="fas fa-user text-white text-hover-secondary"></i></a>
        </span>
      {% endif %}
      {% if search.sector %}
        <span class="badge badge-info">
          {{ search.sector|capfirst }}
        </span>
      {% endif %}
    </h1>
    <ul class="list-group">
      {% for conversation in conversation_list %}
        {% include 'conversations/list-item.html' with show_person=True %}
      {% empty %}
        {% if search.filtered %}
          <p>No people match the applied filters. <a href=".">Reset filters</a></p>
        {% else %}
          <p>
            You have not recorded any conversations yet. 
            <a href="{% url 'conversation_create' %}">Start your first one!</a>
          </p>
        {% endif %}
      {% endfor %}
    </ul>
  </div>
  <div class="col-md-3">
    <h3 class="border-bottom">Filters</h3>
    <h4 class="mt-3">Person</h4>
    {% if search.person %}
      <p class="lead text-info">
        {{ search.person }}
        <a href="{% url 'conversation_list' %}"><i class="fas fa-times text-primary"></i></a>
      </p>
    {% endif %}
    <h4 class="mt-3">Sector</h4>
    {% if not search.sector %}
      <button type="button" class="btn btn-secondary mb-2">All</button>
    {% else %}
      <a class="btn btn-outline-info mb-2" href="{% url 'conversation_list' %}">All</a>
    {% endif %}
    {% for sector in sectors %}
      {% ifequal sector.slug search.sector %}
        <button class="btn btn-secondary mb-2" type="button">{{ sector }}</button>
      {% else %}
        <a class="btn btn-outline-info btn-outline mb-2" 
          href="{% url 'conversation_list' %}?sector={{ sector.slug }}">
          {{ sector }}
        </a>
      {% endifequal %}
    {% endfor %}
  </div>
</div>
{% endblock %}
